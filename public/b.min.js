const wcID=e=>document.getElementById(e),
    wcU=encodeURIComponent(window.location.href),
    newRequest = function(e=!0) {
        fetch("https://api.websitecarbon.com/b?url="+wcU)
            .then((function(e)
            {
                if(!e.ok)
                    throw Error(e);
                return e.json()
            }))
            .then((function(n){e&&renderResult(n),n.t=(new Date).getTime(),localStorage.setItem("wcb_"+wcU,JSON.stringify(n))}))
            .catch((function(e){wcID("wcb_g").innerHTML="No Result",console.log(e),localStorage.removeItem("wcb_"+wcU)}))
    },
    renderResult = function(e) {
        wcID("wcb_g").innerHTML=e.c+"g of CO<sub>2</sub>/view",wcID("wcb_2").
        insertAdjacentHTML("beforeEnd","Cleaner than "+e.p+"% of pages tested")
    },
    wcC="" +
        '<link href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100;0,700;1,600&display=swap" rel="stylesheet">' +
        "<style>" +
        "#wcb.carbonbadge{" +
        "--b2:black;" +
        "font-family: 'Montserrat';" +
        "font-size: .8em;" +
        "text-align:center;" +
        "color:var(--b1);" +
        "line-height:1.15" +
        "}" +
        "#wcb.carbonbadge sub{" +
        "vertical-align:middle;" +
        "position:relative;" +
        "top:.3em;font-size:.7em" +
        "}" +
        "#wcb #wcb_2,#wcb #wcb_a,#wcb #wcb_g{" +
        "display:inline-flex;" +
        "justify-content:center;" +
        "align-items:center;" +
        "text-align:center;" +
        "font-size:1em;" +
        "line-height:1.15;" +
        "text-decoration:none; " +
        "margin:.2em 0" +
        "}" +
        "#wcb #wcb_a,#wcb #wcb_g{" +
        "padding:.3em .5em;" +
        "}" +
        "#wcb #wcb_a{" +
        "border-radius:0 .3em .3em 0;" +
        "border-left:0;" +
        "background:var(--b1);" +
        "color:#fff;" +
        "border-color:var(--b1)" +
        "border-width: .1em" +
        "}" +
        "#wcb.wcb-d #wcb_a{" +
        "border-color:white" +
        "}" +
        "#wcb.wcb-d #wcb_2{" +
        "color:white" +
        "} " +
        "#imageLogo{" +
        "width: 60%;" +
        "}" +
        "#wcb #wcb_p{" +
        "display: flex;" +
        "flex-direction: column;" +
        "width: 9%;" +
        "border:.13em solid var(--b2);" +
        "border-radius: 3%;" +
        "background-color: white;" +
        "}" +
        "#wcb.wcb-d #wcb_p{" +
        "background-color: black;" +
        "border-color:white" +
        "}" +
        "#wcb #titleTest, #wcb #wcb_g{" +
        "font-weight: 700;" +
        "}" +
        "#wcb.wcb-d #titleTest, #wcb.wcb-d #wcb_g{" +
        "color: white;" +
        "}" +
        "#wcb #wcb_2, #wcb #titleTest{" +
        "margin: .4em;" +
        "}" +
        "</style>",
    wcB=wcID("wcb");
if("fetch"in window){
    wcB.insertAdjacentHTML("beforeEnd",wcC),
        wcB.insertAdjacentHTML("beforeEnd",
            '<div id="wcb_p">' +
            '<span id="titleTest">Global Carbon Point</span>' +
            '<a id="wcb_a" target="_blank" rel="noopener" href="https://www.google.com">' +
            '<img id="imageLogo" src="/public/Econos-Logo.png">' +
            '</a>' +
            '<span id="wcb_g">Measuring CO<sub>2</sub>&hellip;</span>' +
            '</span>' +
            '<span id="wcb_2">plus propre que 25% des sites &nbsp;</span>');
    let e=localStorage.getItem("wcb_"+wcU);
    const n=(new Date).getTime();
    if(e){
        const t=JSON.parse(e);renderResult(t),n-t.t>864e5&&newRequest(!1)
    }else newRequest()
}